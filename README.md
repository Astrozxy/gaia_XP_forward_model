This is the tidy-up version of the forward model v2.
